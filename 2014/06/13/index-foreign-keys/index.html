<!DOCTYPE html>
<html>
<head>
<title>Ross-Hunter: Index Your Foreign Keys</title>
<meta content='We add indexes to our database in order to speed up read operations. Basically, an index is a sorted copy of a particular set of columns the dat...' name='description'>
<meta charset='utf-8'>
<meta content='width=device-width, initial-scale=1.0' name='viewport'>
<meta content='IE=edge' http-equiv='X-UA-Compatible'>
<meta content='True' name='HandheldFriendly'>
<link rel="alternate" type="application/atom+xml" title="Atom Feed" href="/feed.xml" />
<link href="../../../../images/images/favicon.ico" rel="icon" type="image/ico" />
<link href="../../../../stylesheets/application-ec71be74.css" rel="stylesheet" />
<link href='//fonts.googleapis.com/css?family=Merriweather:300,700,700italic,300italic|Open+Sans:700,400' rel='stylesheet' type='text/css'>
</head>
<body class='post-template nav-closed'>
<div class='nav'>
<h3 class='nav-title'>Menu</h3>
<a class='nav-close' href='#'>
<span class='hidden'>Close</span>
</a>
<ul>
<li class='nav-home' role='presentation'>
<a href='/'>Home</a>
</li>
<li class='nav-blog' role='presentation'>
<a href='/blog/'>Blog</a>
</li>
<li class='nav-github' role='presentation'>
<a href='https://github.com/ross-hunter'>GitHub</a>
</li>
<li class='nav-twitter' role='presentation'>
<a href='https://twitter.com/ross_hunter'>Twitter</a>
</li>
<li class='nav-linkedin' role='presentation'>
<a href='https://www.linkedin.com/in/rossh'>LinkedIn</a>
</li>
<li class='nav-facebook' role='presentation'>
<a href='http://www.facebook.com/ross.hunter'>Facebook</a>
</li>
</ul>
<a class='subscribe-button icon-feed' href='/feed.xml'>Subscribe</a>
</div>
<span class='nav-cover'></span>

<div class='site-wrapper'>
<header class='main-header post-head' style='background-image: url(../../../../images/index_cards-d227ed5b.jpg)'>
<nav class='clearfix main-nav overlay'>
<a class='menu-button icon-menu' href='#'>
<span class='word'>Menu</span>
</a>
</nav>
</header>
<main class='content' role='main'>
<article class='post'>
<header class='post-header'>
<h1 class='post-title'>Index Your Foreign Keys</h1>
<section class='post-meta'>
<time class='post-date' datetime='2014-06-13'>
13 June 2014
</time>
<a href='/tag/rails/'>rails</a>, <a href='/tag/db/'>db</a>
</section>
</header>
<section class='post-content'><p>We add indexes to our database in order to speed up read operations. Basically, an index is a sorted copy of a particular set of columns the database uses to quickly look up the attributes of another table, most commonly, foreign keys of relations. There are several ways this can actually be implemented on the database; essentially, we tell the database which values we&rsquo;ll be looking up most often and it sorts the logical and physical storage of the information to make those operations faster.</p>

<p>One downside to this process is that it takes more physical space on disk because we&rsquo;re keeping extra copies of data in our database. Another drawback is that because we&rsquo;re keeping these indexes up to date, we also have extra writes whenever that data changes.</p>

<p>I would advise you to index all of your foreign keys, unless you have good reasons not to. Also, if you&rsquo;re already down with indexes, put <code>index: true</code> on your foreign keys in your rails example migrations. I think I was late to the database index game because not enough people are preaching it.</p>

<p>To add indexes to the database of your rails app, create a migration.</p>

<script src="https://gist.github.com/Ross-Hunter/b5ae27f67398c0565873.js"></script>

<p>You can use <a href="https://gist.github.com/tomafro/191181">this script</a> to find missing indexes in your application.</p>

<p>Here are some performance numbers from an application I have been working on, before and after adding database indexes.</p>

<script src="https://gist.github.com/Ross-Hunter/78c0d895c5f7c90e8c19.js"></script>

<p>Speed increased by 4.4x on a simple query and 2.2x on a complex query. Looking around the internet you will find many other people with even greater speed gains.</p>

<p>You can index non-foreign key fields if you query them a lot, such as <code>name</code>, or some other alternative id, and see incredible performance improvements.</p>

<p><em>Originally posted on the <a href="http://www.mutuallyhuman.com/blog/2014/06/13/index-your-foreign-keys/">MHS Blog</a></em></p>
</section>
<footer class='post-footer'>
<figure class='author-image'>
<a class='img' href='/' style='background-image: url(https://www.gravatar.com/avatar/99057d911bd664e8cde1a2995ee25401?size=68)'>
<span class='hidden'>Ross Hunter's Picture</span>
</a>
</figure>
<section class='author'>
<h4>
<a href='/'>Ross Hunter</a>
</h4>
<p></p>
I do things with computers sometimes
<div class='author-meta'>
<span class='author-location icon-location'>Grand Rapids, MI</span>
</div>
</section>
<section class='share'>
<h4>Share this post</h4>
<a class='icon-twitter' href='https://twitter.com/share?text=Index Your Foreign Keys&amp;amp;url=http://www.ross-hunter.com/2014/06/13/index-foreign-keys/' onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;">
<span class='hidden'>Twitter</span>
</a>
<a class='icon-facebook' href='https://www.facebook.com/sharer/sharer.php?u=http://www.ross-hunter.com/2014/06/13/index-foreign-keys/' onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;">
<span class='hidden'>Facebook</span>
</a>
<a class='icon-google-plus' href='https://plus.google.com/share?url=http://www.ross-hunter.com/2014/06/13/index-foreign-keys/' onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;">
<span class='hidden'>Google+</span>
</a>
</section>
<section class='comments'>
<div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/

var disqus_config = function () {
this.page.url = 'http://ross-hunter.com/2014/06/13/index-foreign-keys/';  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = 17; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};

(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = '//ross-hunter.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


</section>
</footer>
</article>
</main>
<aside class='read-next'>
<a class='no-cover read-next-story' href='/2014/06/12/activerecord-associations/'>
<section class='post'>
<h2>ActiveRecord Associations & You</h2>
<p>I love abstraction. It&rsquo;s great to compartmentalize complexity and keep your application modular. SQL is not that. Relying on&hellip;</p>
</section>
</a>
<a class='no-cover prev read-next-story' href='/2016/05/09/topic-based-retro/'>
<section class='post'>
<h2>Topic Based Retro</h2>
<p>At Modustri we have always had weekly retrospectives amongst the dev team. We tried a couple different formats, but&hellip;</p>
</section>
</a>
</aside>

<footer class='site-footer clearfix'>
<section class='copyright'>
<a href='/'>Ross-Hunter</a>
&copy;
2017
</section>
<section class='poweredby'>
Based on the Casper theme powered by
<a href='https://ghost.org' target='_blank'>Ghost</a>
</section>
</footer>
</div>
<script src="../../../../javascripts/application-2ee90952.js"></script>
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
  
  ga('create', 'UA-4184025-5', 'auto');
  ga('send', 'pageview');
</script>
</body>
</html>
